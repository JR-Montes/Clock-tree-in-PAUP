## Árbol ultramétrico en PAUP
March 2020


En este tutorial vamos a utilizar un árbol consenso de MrBayes inferido con plastomas completos de una sección de pinos. El árbol consenso será transformado a un árbol ultramétrico "UPGMA-Style" con verosimilitud y utilizando la opción reloj de molecular forzado en PAUP. PAUP permité estimar el árbol ultramétrico sin modicar el árbol filogenético. Esto es una muy buena opción cuando cuentas con árboles con muchos genes, análisis concatenados o genomas completos. 

Necesitas instalar:

[PAUP](https://paup.phylosolutions.com) en su versión gráfica será necesario para transformra cualquier árbol a ultramétrico.

[Afterphylo](https://github.com/qiyunzhu/AfterPhylo) es un repositorio de github que opera en `Linux` para transformar árboles de RAxML, MrBayes, SVDquartets, GARLI, etc., en formato NEWICK, NEXUS, PHYLIP, etc. 

[FigTree](http://tree.bio.ed.ac.uk/software/figtree/) en su versión gráfica es necesario para editar un árbol filogenético como enraizarlo u ordenar las terminales. 
 

**Requisitos**

A. Alineamiento en formato NEXUS con el cual se construyó el árbol filogenético.



```
#NEXUS
begin data;
	dimensions ntax=59 nchar=117210;
	format datatype=dna missing=? gap=- ;
	matrix
	dis1069	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	disc02	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	dis787	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	joh508	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	joh8199	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	joh8299	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	joh501	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	culJC735	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cul1118	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cul1137	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cem18	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cem593	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cem8599	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cemMPC	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	oriz14	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	ori7399	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	oriz08	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	rem588	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	rem801	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	lag9263	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	lag9279	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	lag2154	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cal1621	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cal1549	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	cal1627	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	calJD	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	fall492	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	fall496	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	fall493	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	edul870	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	edul876	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	mon478	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	mon1214	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	mon1298	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	qua1535	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	qua1546	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	qua1568	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	qua1603	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	max1010	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	max6499	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	pinPA1	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	pinMG2	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	pinPT	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	rzed635	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	rzed637	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	rzed636	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	ariKF30	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	ariKF36	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	ariKF37	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	lon1027	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	balOM11	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	nel1095	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	nel1096	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	nel31798	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	nel10198	AGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	bung03	GGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	ger41105	GGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
	krem242	---------------------------------------------------------SKW
	lam1195	GGTTAGCACGATTAATGATATCAGCCCAAGTGTTAATTACACGGCCTTGACTGTCAACTA
;
end;
	
```

B. Árbol filogenético en formato NEXUS.
	
	
```
#NEXUS
begin trees;
	tree con_50_majrule = [&R] (((((((((((((((culJC735:8.7E-5,cul1137:1.62E-4):1.0E-4,dis1069:2.07E-4,joh8299:6.8E-5):1.01E-4,joh501:4.6E-5):8.2E-5,joh8199:1.09E-4):2.8E-5,cul1118:4.94E-4):3.9E-5,joh508:9.4E-5):1.37E-4,dis787:4.66E-4):9.3E-5,disc02:5.28E-4):4.96E-4,(rem588:2.57E-4,rem801:1.16E-4):0.001179):6.3E-5,((((((cal1549:1.5E-5,fall496:8.2E-5):6.6E-5,cal1627:9.2E-5,edul876:6.5E-5):1.5E-5,edul870:1.78E-4):1.8E-5,calJD:4.9E-5):5.5E-5,fall493:1.78E-4):4.6E-5,(cal1621:5.7E-5,fall492:1.4E-5):1.11E-4):3.4E-4):4.0E-5,(((((cem18:3.89E-4,oriz08:6.1E-5):1.14E-4,ori7399:1.6E-4):1.31E-4,((lag9263:8.9E-5,lag9279:5.2E-5):2.3E-5,oriz14:8.1E-5):3.5E-5):1.9E-5,((cem8599:2.3E-5,cemMPC:1.17E-4):7.4E-5,cem593:3.0E-4):4.8E-5):2.3E-5,lag2154:1.4E-5):7.5E-4):3.5E-4,((((qua1535:8.9E-5,qua1546:1.21E-4):2.3E-5,qua1603:1.72E-4):1.81E-4,qua1568:6.1E-5):6.79E-4,((mon1214:3.2E-4,mon1298:5.1E-5):1.04E-4,mon478:2.93E-4):6.67E-4):4.06E-4):5.21E-4,((((max1010:6.8E-5,max6499:3.32E-4):7.16E-4,pinPA1:6.91E-4):7.9E-5,(pinMG2:6.1E-5,pinPT:8.7E-5):7.92E-4):8.92E-4,((rzed637:5.22E-4,rzed636:4.51E-4):1.33E-4,rzed635:1.28E-4):0.001829):2.64E-4):0.003264,((((ariKF36:4.1E-5,ariKF37:6.0E-6):2.3E-5,ariKF30:1.5E-5):0.001462,(lon1027:0.001228,balOM11:0.001978):3.39E-4):0.002345,(((nel31798:1.9E-4,nel10198:9.8E-5):2.34E-4,nel1096:1.6E-5):2.49E-4,nel1095:8.7E-5):0.005614):7.77E-4):0.003306,(((bung03:0.00134,ger41105:0.001454):0.001907,lam1195:0.005327):1.84E-4,krem242:0.004692):0.00486);
end;

```


A. **Convertir un el árbol.tre a NEXUS**

Copiar o mover el árbol filogenético al directorio de Afterphylo:

`~/ mv tree_consensus.tre ../Afterphylo`


Ir a directorio Afterphylo en tu terminal de linux. Convertir el árbol den formato NEWICK. a NEXUS.

```
~/ cd Afterphylo
~/ perl Afterphylo -format=nexus tree_consensus.tree
```

B. **Transformar árbol ultramétrico en PAUP**

En PAUP primer debes abrir y ejecutear el alineamiento.

```
File > Open > Elijes archivo > execute
```

C. Elijes parámetros para convertir el árbol a ultramétrico: Los parámetros van en función del tipo de datos.

```
Analysis > Likelihood setings > substitution rates > State frequency > Across-site  > starting values > Optimization > other > OK
```

**Substitution rates**: GTR = st 6

**State frequency**: Estimate y HKY85

**Across-site rates**: Gamma distribution

**Starting values**: by default

**Optimization**: by default

**Other** Enforce molecular clock > Thorne 


D. Ahora debes cargar el árbol en formato NEXUS

```
File > Open > Elijes archivo > execute

```

![Consensus tree](https://github.com/JR-Montes/Clock-tree-in-PAUP/blob/master/Cembroides_Plastomes_T59_HighCov_tree_MB.pdf)


E. Ahora debes ejecutar el análisis.

```
Analysis > Likelihood

```

F. Finalmente debes escribir los siguiente comandos en la pestaña de abajo de PAUP para ejecutar el programa. 

```
des /plot=phylo;
```
 El programa debe tranformar el árbol y se debe imprimir lo siguiente:
 
 ![Resultados](https://github.com/JR-Montes/Clock-tree-in-PAUP/blob/master/Captura%20de%20pantalla%202020-01-24%20a%20la(s)%2013.31.15.png)
 
 
 
 ![Ultrametric tree](https://github.com/JR-Montes/Clock-tree-in-PAUP/blob/master/Cembroides_Plastomes_T59_HighCov_tree.pdf)
 
 Listo ahora puedes guardar el árbol.
 
 





